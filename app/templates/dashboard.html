{% extends "base.html" %}
{% block body %}
  <h1>Welcome, {{ username }}!</h1>
  <p class="post-meta">Manage your content below.</p>
  {% for post in my_posts %}
    <article class="card" style="margin:12px 0;">
      <h3><a href="{{ url_for('main.post_detail', post_id=post.id) }}" style="color:#fff; text-decoration:none">{{ post.title }}</a></h3>
      <div class="post-meta">{{ post.date_posted.strftime('%Y-%m-%d') }}</div>
      <p>{{ post.content | truncate(200) }}</p>
      <div class="post-actions">
        <a class="btn muted" href="{{ url_for('main.edit_post', post_id=post.id) }}">Edit</a>
        <form action="{{ url_for('main.delete_post', post_id=post.id) }}" method="post" onsubmit="return confirm('Delete this post?');">
          <button type="submit" class="btn danger">Delete</button>
        </form>
      </div>
    </article>
  {% else %}
    <p>You haven't created any posts yet.</p>
  {% endfor %}

  {% if p %}
  <div class="pagination">
    {% if p.has_prev %}
      <a href="{{ request.path }}?page={{ p.prev_num }}">&laquo; Prev</a>
    {% else %}
      <span>Start</span>
    {% endif %}
    {% for num in range(1, p.pages + 1) %}
      {% if num == p.page %}
        <span class="active">{{ num }}</span>
      {% else %}
        <a href="{{ request.path }}?page={{ num }}">{{ num }}</a>
      {% endif %}
    {% endfor %}
    {% if p.has_next %}
      <a href="{{ request.path }}?page={{ p.next_num }}">Next &raquo;</a>
    {% else %}
      <span>End</span>
    {% endif %}
  </div>
  {% endif %}
{% endblock %}
