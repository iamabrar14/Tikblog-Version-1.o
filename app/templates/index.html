{% extends "base.html" %}
{% block body %}
  <h2>Latest Blog Posts</h2>
  {% for post in posts %}
    <article class="card" style="margin:14px 0;">
      <h3><a href="{{ url_for('main.post_detail', post_id=post.id) }}" style="color:#fff; text-decoration:none">{{ post.title }}</a></h3>
      <div class="post-meta">By {{ post.author.username }} Â· {{ post.date_posted.strftime('%Y-%m-%d') }}</div>
      <p>{{ post.content | truncate(220) }}</p>
      <div class="post-actions">
        <a class="btn outline" href="{{ url_for('main.post_detail', post_id=post.id) }}">Read</a>
        {% if current_user.is_authenticated and current_user == post.author %}
          <a class="btn muted" href="{{ url_for('main.edit_post', post_id=post.id) }}">Edit</a>
        {% endif %}
      </div>
    </article>
  {% else %}
    <p>No posts found. Be the first to post!</p>
  {% endfor %}

  {% if p %}
  <div class="pagination">
    {% if p.has_prev %}
      <a href="{{ request.path }}?page={{ p.prev_num }}">&laquo; Prev</a>
    {% else %}
      <span>Start</span>
    {% endif %}
    {% for num in range(1, p.pages + 1) %}
      {% if num == p.page %}
        <span class="active">{{ num }}</span>
      {% else %}
        <a href="{{ request.path }}?page={{ num }}">{{ num }}</a>
      {% endif %}
    {% endfor %}
    {% if p.has_next %}
      <a href="{{ request.path }}?page={{ p.next_num }}">Next &raquo;</a>
    {% else %}
      <span>End</span>
    {% endif %}
  </div>
  {% endif %}
{% endblock %}
